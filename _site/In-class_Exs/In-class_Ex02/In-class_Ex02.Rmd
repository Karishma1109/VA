---
title: "Untitled"
description: |
  A new article created using the Distill format.
author:
  - name: Karishma Yadav
    url: https://www.linkedin.com/in/karishma-yadav-02310a168/
    affiliation: SCIS, Singapore Management University
    affiliation_url: https://scis.smu.edu.sg/
date: "`r Sys.Date()`"
output: distill::distill_article
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r}
packages = c('tidyverse', 'readxl','knitr')
for(p in packages){
  if(!require(p,character.only = T)){
    install.packages(p)
  }
  library(p,character.only = T)
}
```

```{r, echo = TRUE, warning = FALSE, message = FALSE}
orders <- read_xls("Data/Superstore-2021.xls",
                   sheet = "Orders")
returns <- read_xls("data/Superstore-2021.xls",
                   sheet = "Returns")
```
### Inner Join for orders and returns

```{r}
joined_tab <- left_join(returns, orders, 
                        by = c('Order ID' = 'Order ID'))
```

```{r}
freq_returned <- joined_tab %>% group_by(`Sub-Category`) %>% summarise("Returns"=n()) %>%
  ungroup()
```

```{r}
freq_sorted <- freq_returned %>%
  arrange(desc(Returns))
```

```{r}
freq_cum <- freq_sorted %>%
  mutate(cumfreq = cumsum(Returns))
```